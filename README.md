# Concurrent Clan
Пользователи могут конкурентно изменять количество золота в казне клана.
При этом изменения происходят потокобезопасно.
### Логика добавления/уменьшения золота в клане
* Синхронизация - интерфейс `Lock`, добавленный в каждый `Clan`, а также `volatile` модификатор переменной "gold"
* При захвате блокировки блокируется только один клан, а не все сразу
* Весь механизм синхронизации вынесен в отдельный класс - `ConcurrentGoldAdderImpl`
* Блокировка распространяется только на фрагмент кода, где происходит обновление количества золота и сохранение клана
### Отслеживание транзакций с золотом
* Реализовано в виде записи транзакционной информации в базу данных `PostgreSQL` с помощью `JDBC` драйвера
* Информация о транзакции собирается с помощью паттерна `Builder` в классе `GoldTransaction`
* Каждая транзакция с золотом записывается в базу данных - логика в классах `GoldTransactionTrackerImpl` и `GoldTransactionRepositoryImpl`
* Во время записи потоки не блокируются, так как информация о каждой транзакции
сохраняется в локальных переменных каждого потока (после блокировки на изменение количества золота в клане никаких блокировок не устанавливается)
* За соединение с базой данных отвечает класс `DBConnection` -
в качестве улучшения текущей реализации можно перейти на использование пула соединений `HikariCP`

Новые кланы берутся из `HashMap`, сохраняются тоже в `HashMap` (`ClanProducer` и `ClanConsumer`)